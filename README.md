# portdex (portfolio index)

**portdex** - персональный индекс инвестиционного портфеля, на базе данных Московской биржи (MOEX).

Проект автоматически:
- Читает сделки из google sheets
- загружает рыночные данные (японские свечи) с MOEX
- восстанавливает стоимость портфеля по времени
- рассчитывает индекс портфеля
- хранит историю для анализа и визуализации

Проект задумывался как **self-hosted сервис** (то есть docker-контейнер крутится на Вашем сервере с выходом в интернет)

---

## Формат входных данных
Предполагается, что в Вашем google-sheets лежит таблица со сделками в следующем формате:

| Тикер | Название акции | Дата | Стоимость одной акции, руб | Количество штук | Комиссия, руб | Тип операции |
| --- | --- | --- | --- | --- | --- | --- |
| GAZP | Газпром | 30.09.2025 | 100 | 100 | 70,1 | Покупка |
| SBER | Сбер | 28.11.2025 | 300 | 43 | 128,8 | Покупка |

---

TODO:
- [ ] MOEX ISS API
- [ ] Fetcher (1 раз в час)
- [ ] Raw market data (candles, prices)
- [ ] Portfolio valuation
- [ ] Index calculation
- [ ] Storage (DB + backups)
- [ ] Monitoring

--- 

Запуск

Проект использует **Google service accaunt**, не OAuth/OAuth2.
Шаги:

- Создайте Google Cloud Project
- Включите **Google Sheets API**, **Google Drive API**
- Создайте Service Account, дайте ему доступ к Вашей таблице с данными
- Скачайте credentials.json и положите в корень проекта (ни в коем случае не добавляйте его в git или куда-либо еще!)

Скопируйте файл .env.example в .env и заполните его своими данными

```bash
cp .env.example .env

# Запуск docker-контейнера
docker compose up --build
# или
docker-compose up --build
```

---

Рассчет индекса происходит по формуле

$$
R_t = (V_t - V_{t-1} - CF_t) / V_{t-1}
Index_t = Index_{t-1} \times (1 + R_t)
$$

$V_t$ - стоимость портфеля на момент $t$, 
$CF_t$ - cashflow (покупки, продажи, комиссии)

---

Проект реализован в исключительно ознакомительных целях, никакие данные, полученные в ходе работы, не являются инвестиционной или какой-либо еще рекомендацией!
